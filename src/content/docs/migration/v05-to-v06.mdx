---
title: "Migrating from v0.5 to v0.6"
description: "Breaking changes and upgrade steps for Attest v0.5.x to v0.6.x."
---

## Overview

v0.6.0 is an engine-only performance release with no SDK breaking changes. v0.6.1 introduces TypeScript SDK changes that require attention if you use the TypeScript SDK.

**Python SDK users:** No breaking changes. Update to `attest-ai>=0.6.1` for new `TraceTree.summary()` analytics.

**TypeScript SDK users:** Two breaking changes in v0.6.1 — adapter API rename and CJS dual output.

## TypeScript Breaking Changes

### 1. Adapter API: `capture()` → `traceFromResponse()`

All TypeScript adapter methods that previously used `capture()` are renamed to `traceFromResponse()`.

**Before (v0.5.x):**

```typescript
import { OpenAIAdapter } from '@attest-ai/core/adapters/openai';

const adapter = new OpenAIAdapter();
const trace = adapter.capture(response);
```

**After (v0.6.1):**

```typescript
import { OpenAIAdapter } from '@attest-ai/core/adapters/openai';

const adapter = new OpenAIAdapter();
const trace = adapter.traceFromResponse(response);
```

This applies to all adapters: `OpenAIAdapter`, `AnthropicAdapter`, `GeminiAdapter`, `OllamaAdapter`, and the new `LangChainAdapter`.

### 2. CJS Dual Output

`@attest-ai/core` and `@attest-ai/vitest` now ship both ESM and CommonJS bundles via tsup. The `package.json` `exports` map handles format resolution automatically.

**Action required:** If you previously used a bundler workaround (e.g., Vite `optimizeDeps`, webpack `resolve.alias`) to handle ESM-only imports, remove it. The package now resolves correctly in both module systems.

**No action required** if you already use ESM (`"type": "module"` in your `package.json`).

## New TypeScript Features

### Discriminated Union Steps

`Step` now uses a `kind` discriminant for exhaustive pattern matching:

```typescript
import type { Step } from '@attest-ai/core';

function handleStep(step: Step) {
  switch (step.kind) {
    case 'llm_call':
      console.log(step.model);
      break;
    case 'tool_call':
      console.log(step.tool_name);
      break;
    case 'retrieval':
      console.log(step.query);
      break;
    case 'agent_call':
      console.log(step.agent_id);
      break;
  }
}
```

### Branded Types

`TraceId`, `AssertionId`, and `AgentId` are branded string types that prevent accidental mixing:

```typescript
import type { TraceId, AgentId } from '@attest-ai/core';

function getTrace(id: TraceId): Trace { /* ... */ }

const traceId = 'trc_abc123' as TraceId;
const agentId = 'agent-1' as AgentId;

getTrace(traceId);  // OK
getTrace(agentId);  // Type error: AgentId is not assignable to TraceId
```

### Plugin System

Register custom assertion plugins:

```typescript
import { PluginRegistry, type AttestPlugin } from '@attest-ai/core';

const myPlugin: AttestPlugin = {
  name: 'toxicity-check',
  evaluate: async (trace, config) => {
    // Custom evaluation logic
    return { passed: true, score: 0.95 };
  },
};

PluginRegistry.register(myPlugin);
```

### Continuous Evaluation

Run assertions continuously with sampling:

```typescript
import { ContinuousEvalRunner, Sampler, AlertDispatcher } from '@attest-ai/core';

const runner = new ContinuousEvalRunner({
  sampler: Sampler.percentage(10),  // 10% of requests
  alert: new AlertDispatcher({ webhook: 'https://...' }),
});

runner.start();
```

### LangChain.js Adapter

```typescript
import { LangChainAdapter } from '@attest-ai/core/adapters/langchain';

const adapter = new LangChainAdapter();
// Automatically instruments LangChain.js callback manager
const trace = adapter.traceFromResponse(agentResponse);
```

## New Python Features

### TraceTree.summary()

Aggregate metrics across multi-agent trace trees:

```python
from attest import TraceTree

tree = TraceTree.from_trace(result.trace)
summary = tree.summary()
# summary.total_cost, summary.total_tokens, summary.total_latency_ms
# summary.agent_count, summary.max_depth
```

### New ExpectChain Methods

```python
# Chain plugin assertions
expect(result).plugin("my_plugin", {"threshold": 0.9})

# Aggregate latency across all steps
expect(result).aggregate_latency_under(5000)

# Verify all expected tools were called
expect(result).all_tools_called(["search", "summarize", "format"])
```

## Engine Performance (v0.6.0)

No configuration changes required. Performance improvements are automatic:

- Schema compilation caching (~3x faster repeated evaluations)
- Trace validation short-circuit (non-verbose mode)
- SQL covering indexes and prepared statement pooling
- segmentio/encoding JSON codec (~2x faster marshal/unmarshal)
- Result pagination via `limit`/`offset` on `list_results`

## Upgrade Steps

### Python

```bash
uv add attest-ai@latest
```

### TypeScript

```bash
pnpm add @attest-ai/core@latest @attest-ai/vitest@latest
```

### Engine

The engine binary auto-updates via the SDK's auto-download mechanism. To update manually:

```bash
# Download latest engine
export ATTEST_ENGINE_PATH=/usr/local/bin/attest-engine
curl -L https://github.com/attest-framework/attest/releases/latest/download/attest-engine-$(uname -s)-$(uname -m) -o $ATTEST_ENGINE_PATH
chmod +x $ATTEST_ENGINE_PATH
```
